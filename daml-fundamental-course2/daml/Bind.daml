module Bind where

import Daml.Script

-- binding actions 
safeDiv: Int -> Int -> Optional Int
safeDiv _ 0 = None
safeDiv x y = Some (x/y)

reduce: Int -> Optional Int
reduce x
   | x <= 0 = None
   | otherwise = Some (x-1)

testAction: Script()
testAction = script do
    let 
      a = safeDiv 4 2
      b = safeDiv 4 0
                      -- result of safeDiv piped into reduce
      c = safeDiv 4 2 >>= reduce
      d = safeDiv 4 0 >>= reduce

    debug a
    debug b
    debug c
    debug d